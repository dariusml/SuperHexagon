\hypertarget{_intro___scene_8hpp_source}{}\doxysection{Intro\+\_\+\+Scene.\+hpp}
\mbox{\hyperlink{_intro___scene_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Intro\_Scene}}
\DoxyCodeLine{3 \textcolor{comment}{ * Copyright © 2021+ Darío Muñoz Lanuza}}
\DoxyCodeLine{4 \textcolor{comment}{ *}}
\DoxyCodeLine{5 \textcolor{comment}{ * Distributed under the Boost Software License, version  1.0}}
\DoxyCodeLine{6 \textcolor{comment}{ * See documents/LICENSE.TXT or www.boost.org/LICENSE\_1\_0.txt}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ */}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <basics/Canvas>}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <basics/Scene>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <basics/Texture\_2D>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <basics/Timer>}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_menu___scene_8hpp}{Menu\_Scene.hpp}}"{}}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <basics/Canvas>}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <basics/Director>}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacehexagon_game}{hexagonGame}}}
\DoxyCodeLine{21 \{}
\DoxyCodeLine{22 }
\DoxyCodeLine{23     \textcolor{keyword}{using namespace }basics;}
\DoxyCodeLine{24     \textcolor{keyword}{using namespace }std;}
\DoxyCodeLine{25     \textcolor{keyword}{using} basics::Timer;}
\DoxyCodeLine{26     \textcolor{keyword}{using} basics::Canvas;}
\DoxyCodeLine{27     \textcolor{keyword}{using} basics::Texture\_2D;}
\DoxyCodeLine{28     \textcolor{keyword}{using} basics::Graphics\_Context;}
\DoxyCodeLine{29 }
\DoxyCodeLine{33     \textcolor{keyword}{class }\mbox{\hyperlink{classhexagon_game_1_1_intro___scene}{Intro\_Scene}} : \textcolor{keyword}{public} basics::Scene}
\DoxyCodeLine{34     \{}
\DoxyCodeLine{35 }
\DoxyCodeLine{39         \textcolor{keyword}{enum} State}
\DoxyCodeLine{40         \{}
\DoxyCodeLine{41             UNINITIALIZED,}
\DoxyCodeLine{42             LOADING,}
\DoxyCodeLine{43             FADING\_IN,}
\DoxyCodeLine{44             WAITING,}
\DoxyCodeLine{45             FADING\_OUT,}
\DoxyCodeLine{46             FINISHED,}
\DoxyCodeLine{47             ERROR}
\DoxyCodeLine{48         \};}
\DoxyCodeLine{49 }
\DoxyCodeLine{50     \textcolor{keyword}{private}:}
\DoxyCodeLine{51 }
\DoxyCodeLine{52         State    state;                                     }
\DoxyCodeLine{53         \textcolor{keywordtype}{bool}     suspended;                                 }
\DoxyCodeLine{54 }
\DoxyCodeLine{55         \textcolor{keywordtype}{unsigned} canvas\_width;                              }
\DoxyCodeLine{56         \textcolor{keywordtype}{unsigned} canvas\_height;                             }
\DoxyCodeLine{57 }
\DoxyCodeLine{58         Timer    timer;                                     }
\DoxyCodeLine{59 }
\DoxyCodeLine{60         \textcolor{keywordtype}{float}    opacity;                                   }
\DoxyCodeLine{61 }
\DoxyCodeLine{62         std::shared\_ptr < Texture\_2D > logo\_texture;        }
\DoxyCodeLine{63         \textcolor{keywordtype}{bool}     aspect\_ratio\_adjusted;}
\DoxyCodeLine{64 }
\DoxyCodeLine{65     \textcolor{keyword}{public}:}
\DoxyCodeLine{66 }
\DoxyCodeLine{70         \mbox{\hyperlink{classhexagon_game_1_1_intro___scene_a1ac03c9ac649a2fc9ab005fef3ece29f}{Intro\_Scene}}()}
\DoxyCodeLine{71         \{}
\DoxyCodeLine{72             state         = UNINITIALIZED;}
\DoxyCodeLine{73             suspended     = \textcolor{keyword}{true};}
\DoxyCodeLine{74             canvas\_width  = 1280;}
\DoxyCodeLine{75             canvas\_height =  720;}
\DoxyCodeLine{76         \}}
\DoxyCodeLine{77 }
\DoxyCodeLine{83         basics::Size2u \mbox{\hyperlink{classhexagon_game_1_1_intro___scene_a5858a151bc5ce4ade3095eae7213fa8e}{get\_view\_size}} ()\textcolor{keyword}{ override}}
\DoxyCodeLine{84 \textcolor{keyword}{        }\{}
\DoxyCodeLine{85             \textcolor{keywordflow}{return} \{ canvas\_width, canvas\_height \};}
\DoxyCodeLine{86         \}}
\DoxyCodeLine{87 }
\DoxyCodeLine{91         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classhexagon_game_1_1_intro___scene_abfe3afb2359e4e0cba70399451303875}{initialize}} ()\textcolor{keyword}{ override}}
\DoxyCodeLine{92 \textcolor{keyword}{        }\{}
\DoxyCodeLine{93             \textcolor{keywordflow}{if} (state == UNINITIALIZED)}
\DoxyCodeLine{94             \{}
\DoxyCodeLine{95                 state = LOADING;}
\DoxyCodeLine{96             \}}
\DoxyCodeLine{97             \textcolor{keywordflow}{else}}
\DoxyCodeLine{98             \{}
\DoxyCodeLine{99                 timer.reset ();}
\DoxyCodeLine{100 }
\DoxyCodeLine{101                 opacity = 0.f;}
\DoxyCodeLine{102                 state   = FADING\_IN;}
\DoxyCodeLine{103             \}}
\DoxyCodeLine{104             \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{105         \}}
\DoxyCodeLine{106 }
\DoxyCodeLine{110         \textcolor{keywordtype}{void} \mbox{\hyperlink{classhexagon_game_1_1_intro___scene_acf9a12ff246782f202558639e1dae317}{suspend}} ()\textcolor{keyword}{ override}}
\DoxyCodeLine{111 \textcolor{keyword}{        }\{}
\DoxyCodeLine{112             suspended = \textcolor{keyword}{true};}
\DoxyCodeLine{113         \}}
\DoxyCodeLine{114 }
\DoxyCodeLine{118         \textcolor{keywordtype}{void} \mbox{\hyperlink{classhexagon_game_1_1_intro___scene_a0d4d4832185b582c2719a74d423a6d11}{resume}} ()\textcolor{keyword}{ override}}
\DoxyCodeLine{119 \textcolor{keyword}{        }\{}
\DoxyCodeLine{120             suspended = \textcolor{keyword}{false};}
\DoxyCodeLine{121         \}}
\DoxyCodeLine{122 }
\DoxyCodeLine{128         \textcolor{keywordtype}{void} \mbox{\hyperlink{classhexagon_game_1_1_intro___scene_a93799a2e6f1d57689720d728d71f8ed9}{update}} (\textcolor{keywordtype}{float} time)\textcolor{keyword}{ override}}
\DoxyCodeLine{129 \textcolor{keyword}{        }\{}
\DoxyCodeLine{130             \textcolor{keywordflow}{if} (!suspended) \textcolor{keywordflow}{switch} (state)}
\DoxyCodeLine{131                 \{}
\DoxyCodeLine{132                     \textcolor{keywordflow}{case} LOADING:    update\_loading    ();}
\DoxyCodeLine{133                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{134                     \textcolor{keywordflow}{case} FADING\_IN:  update\_fading\_in  (); \textcolor{keywordflow}{break};}
\DoxyCodeLine{135                     \textcolor{keywordflow}{case} WAITING:    update\_waiting    (); \textcolor{keywordflow}{break};}
\DoxyCodeLine{136                     \textcolor{keywordflow}{case} FADING\_OUT: update\_fading\_out (); \textcolor{keywordflow}{break};}
\DoxyCodeLine{137                     \textcolor{keywordflow}{default}: \textcolor{keywordflow}{break};}
\DoxyCodeLine{138                 \}}
\DoxyCodeLine{139         \}}
\DoxyCodeLine{140 }
\DoxyCodeLine{145         \textcolor{keywordtype}{void} \mbox{\hyperlink{classhexagon_game_1_1_intro___scene_a9da8f3b2efad5c11a04827e01c2c7bf8}{render}} (Graphics\_Context::Accessor \& context)\textcolor{keyword}{ override}}
\DoxyCodeLine{146 \textcolor{keyword}{        }\{}
\DoxyCodeLine{147             \textcolor{keywordflow}{if} (!suspended)}
\DoxyCodeLine{148             \{}
\DoxyCodeLine{149                 \textcolor{comment}{// El canvas se puede haber creado previamente, en cuyo caso solo hay que pedirlo:}}
\DoxyCodeLine{150 }
\DoxyCodeLine{151                 Canvas * canvas = context-\/>get\_renderer< Canvas > (ID(canvas));}
\DoxyCodeLine{152 }
\DoxyCodeLine{153                 \textcolor{comment}{// Si no se ha creado previamente, hay que crearlo una vez:}}
\DoxyCodeLine{154 }
\DoxyCodeLine{155                 \textcolor{keywordflow}{if} (!canvas \&\& aspect\_ratio\_adjusted)}
\DoxyCodeLine{156                 \{}
\DoxyCodeLine{157                     canvas = Canvas::create (ID(canvas), context, \{\{ canvas\_width, canvas\_height \}\});}
\DoxyCodeLine{158                 \}}
\DoxyCodeLine{159 }
\DoxyCodeLine{160                 \textcolor{comment}{// Si el canvas se ha podido obtener o crear, se puede dibujar con Ã©l:}}
\DoxyCodeLine{161 }
\DoxyCodeLine{162                 \textcolor{keywordflow}{if} (canvas)}
\DoxyCodeLine{163                 \{}
\DoxyCodeLine{164                     canvas-\/>clear ();}
\DoxyCodeLine{165 }
\DoxyCodeLine{166                     \textcolor{keywordflow}{if} (logo\_texture)}
\DoxyCodeLine{167                     \{}
\DoxyCodeLine{168                         canvas-\/>set\_opacity (opacity);}
\DoxyCodeLine{169 }
\DoxyCodeLine{170                         canvas-\/>fill\_rectangle}
\DoxyCodeLine{171                                 (}
\DoxyCodeLine{172                                         \{ canvas\_width * .5f, canvas\_height * .5f \},}
\DoxyCodeLine{173                                         \{ logo\_texture-\/>get\_width (), logo\_texture-\/>get\_height () \},}
\DoxyCodeLine{174                                         logo\_texture. get ()}
\DoxyCodeLine{175                                 );}
\DoxyCodeLine{176                     \}}
\DoxyCodeLine{177                 \}}
\DoxyCodeLine{178             \}}
\DoxyCodeLine{179         \}}
\DoxyCodeLine{180 }
\DoxyCodeLine{181     \textcolor{keyword}{private}:}
\DoxyCodeLine{182 }
\DoxyCodeLine{183 }
\DoxyCodeLine{184         \textcolor{keywordtype}{void} update\_loading ()}
\DoxyCodeLine{185         \{}
\DoxyCodeLine{186             Graphics\_Context::Accessor context = director.lock\_graphics\_context ();}
\DoxyCodeLine{187 }
\DoxyCodeLine{188             \textcolor{keywordflow}{if} (context)}
\DoxyCodeLine{189             \{}
\DoxyCodeLine{190                 \textcolor{comment}{//Se ajusta el aspect ratio, que servira para las demas escenas}}
\DoxyCodeLine{191                 adjustAspectRatio(context);}
\DoxyCodeLine{192 }
\DoxyCodeLine{193                 \textcolor{comment}{// Se carga la textura del logo:}}
\DoxyCodeLine{194 }
\DoxyCodeLine{195                 logo\_texture = Texture\_2D::create (0, context, \textcolor{stringliteral}{"{}logo.png"{}});}
\DoxyCodeLine{196 }
\DoxyCodeLine{197                 \textcolor{comment}{// Se comprueba si la textura se ha podido cargar correctamente:}}
\DoxyCodeLine{198 }
\DoxyCodeLine{199                 \textcolor{keywordflow}{if} (logo\_texture)}
\DoxyCodeLine{200                 \{}
\DoxyCodeLine{201                     context-\/>add (logo\_texture);}
\DoxyCodeLine{202 }
\DoxyCodeLine{203                     timer.reset ();}
\DoxyCodeLine{204 }
\DoxyCodeLine{205                     opacity = 0.f;}
\DoxyCodeLine{206                     state   = FADING\_IN;}
\DoxyCodeLine{207                 \}}
\DoxyCodeLine{208                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{209                     state   = ERROR;}
\DoxyCodeLine{210             \}}
\DoxyCodeLine{211         \}}
\DoxyCodeLine{212 }
\DoxyCodeLine{213         \textcolor{keywordtype}{void} update\_fading\_in ()}
\DoxyCodeLine{214         \{}
\DoxyCodeLine{215             \textcolor{keywordtype}{float} elapsed\_seconds = timer.get\_elapsed\_seconds ();}
\DoxyCodeLine{216 }
\DoxyCodeLine{217             \textcolor{keywordflow}{if} (elapsed\_seconds < 1.f)}
\DoxyCodeLine{218             \{}
\DoxyCodeLine{219                 opacity = elapsed\_seconds;      \textcolor{comment}{// Se aumenta la opacidad del logo a medida que pasa el tiempo}}
\DoxyCodeLine{220             \}}
\DoxyCodeLine{221             \textcolor{keywordflow}{else}}
\DoxyCodeLine{222             \{}
\DoxyCodeLine{223                 timer.reset ();}
\DoxyCodeLine{224 }
\DoxyCodeLine{225                 opacity = 1.f;}
\DoxyCodeLine{226                 state   = WAITING;}
\DoxyCodeLine{227             \}}
\DoxyCodeLine{228         \}}
\DoxyCodeLine{229 }
\DoxyCodeLine{230         \textcolor{keywordtype}{void} update\_waiting ()}
\DoxyCodeLine{231         \{}
\DoxyCodeLine{232             \textcolor{comment}{// Se esperan dos segundos sin hacer nada:}}
\DoxyCodeLine{233 }
\DoxyCodeLine{234             \textcolor{keywordflow}{if} (timer.get\_elapsed\_seconds () > 2.f)}
\DoxyCodeLine{235             \{}
\DoxyCodeLine{236                 timer.reset ();}
\DoxyCodeLine{237 }
\DoxyCodeLine{238                 state = FADING\_OUT;}
\DoxyCodeLine{239             \}}
\DoxyCodeLine{240         \}}
\DoxyCodeLine{241 }
\DoxyCodeLine{242         \textcolor{keywordtype}{void} update\_fading\_out ()}
\DoxyCodeLine{243         \{}
\DoxyCodeLine{244             \textcolor{keywordtype}{float} elapsed\_seconds = timer.get\_elapsed\_seconds ();}
\DoxyCodeLine{245 }
\DoxyCodeLine{246             \textcolor{keywordflow}{if} (elapsed\_seconds < .5f)}
\DoxyCodeLine{247             \{}
\DoxyCodeLine{248                 opacity = 1.f -\/ elapsed\_seconds * 2.f;      \textcolor{comment}{// Se reduce la opacidad de 1 a 0 en medio segundo}}
\DoxyCodeLine{249             \}}
\DoxyCodeLine{250             \textcolor{keywordflow}{else}}
\DoxyCodeLine{251             \{}
\DoxyCodeLine{252                 \textcolor{comment}{// Cuando el faceout se ha completado, se lanza la siguiente escena:}}
\DoxyCodeLine{253 }
\DoxyCodeLine{254                 state = FINISHED;}
\DoxyCodeLine{255 }
\DoxyCodeLine{256                 director.run\_scene (shared\_ptr< Scene >(\textcolor{keyword}{new} Menu\_Scene));}
\DoxyCodeLine{257             \}}
\DoxyCodeLine{258         \}}
\DoxyCodeLine{259 }
\DoxyCodeLine{260         \textcolor{keywordtype}{void} adjustAspectRatio(Graphics\_Context::Accessor \& context)}
\DoxyCodeLine{261         \{}
\DoxyCodeLine{262             \textcolor{keywordflow}{if} (!aspect\_ratio\_adjusted)}
\DoxyCodeLine{263             \{}
\DoxyCodeLine{264 }
\DoxyCodeLine{265                 \textcolor{keywordtype}{float} real\_aspect\_ratio = float( context-\/>get\_surface\_width () ) / context-\/>get\_surface\_height ();}
\DoxyCodeLine{266 }
\DoxyCodeLine{267                 canvas\_width = unsigned( canvas\_height * real\_aspect\_ratio );}
\DoxyCodeLine{268 }
\DoxyCodeLine{269                 aspect\_ratio\_adjusted = \textcolor{keyword}{true};}
\DoxyCodeLine{270             \}}
\DoxyCodeLine{271         \}}
\DoxyCodeLine{272     \};}
\DoxyCodeLine{273 }
\DoxyCodeLine{274 \}}

\end{DoxyCode}
